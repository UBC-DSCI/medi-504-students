---
title: "Lecture 3: Introduction to biostatistics"
subtitle: "MEDI 504"  
author: 
  - "@TiffanyTimbers (UBC)"
  - "`r Sys.Date()`"
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: xaringan-themer.css
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      slideNumberFormat: '%current%'
      titleSlideClass: [top, left]
      ratio: '16:9'
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
library(knitr)
opts_chunk$set(echo = TRUE)
```

```{r xaringan-themer, include=FALSE, warning=FALSE}
library(xaringanthemer)
style_duo_accent(
  primary_color = "#9F999C",
  secondary_color = "#FFE5F3",
  inverse_header_color = "#8F8C8E",
  link_color = "deeppink",
  title_slide_text_color = "#3d3d3d",
  title_slide_background_image = "img/title-slide-background-light.png",
  title_slide_background_position = "left",
  header_font_google = google_font("Josefin Sans"),
  text_font_google   = google_font("Montserrat", "300", "300i"),
  code_font_google   = google_font("Fira Mono")
)
```

## Module learning objectives

By the end of this module, students should be able to:

- Identify the different types of data analysis questions and categorize a question into the correct type

- Identify a suitable analysis type to answer an inferential question, given the data set at hand

- Use the R programming language to carry out analysis to answer inferential question

- Interpret and communicate the results of the analysis from an inferential question

---

## What is the question?

```{r what-is-the-q, out.width = "50%", echo = FALSE, fig.cap = "What is the question? by Roger Peng and Jeff Leek"}
include_graphics("img/what_is_the_question.png")
```

---

#### 1. Descriptive

One that seeks to summarize a characteristic of a set of data. No interpretation of the result itself as the result is a fact, an attribute of the data set you are working with.

--

Examples:

- What is the frequency of viral illnesses in a set of data collected from a group of individuals?

--

- How many people live in each US state?

---

#### 2. Exploratory

One in which you analyze the data to see if there are patterns, trends, or relationships between variables looking for patterns that would support proposing a hypothesis to test in a future study.

--

Examples:

- Do diets rich in certain foods have differing frequencies of viral illnesses **in a set of data** collected from a group of individuals? 

--

- Does air pollution correlate with life expectancy **in a set of data** collected from groups of individuals from several regions in the United States?  

---

#### 3. Inferential

One in which you analyze the data to see if there are patterns, trends, or relationships between variables in a representative sample. We want to quantify how much the patterns, trends, or relationships between variables is applicable to all individuals units in the population.

--

Examples:

- Is eating at least 5 servings a day of fresh fruit and vegetables is associated with fewer viral illnesses per year?

--

- Is the gestational length of first born babies the same as that of non-first borns?

---

#### 4. Predictive

One where you are trying to predict measurements or labels for individuals (people or things). Less interested in what causes the predicted outcome, just what predicts it.

--

Examples: 

- How many viral illnesses will someone have next year?

--

- What political party will someone vote for in the next US election?

---

#### 5. Causal

Asks about whether changing one factor will change another factor, on average, in a population. Sometimes the underlying design of the data collection, by default, allows for the question that you ask to be causal (e.g., randomized experiment or trial)

--

Examples:

- Does eating at least 5 servings a day of fresh fruit and vegetables cause fewer viral illnesses per year?

--

- Does smoking lead to cancer?

---

#### 6. Mechanistic

One that tries to explain the underlying mechanism of the observed patterns, trends, or relationship (how does it happen?)

--

Examples:

- How do changes in diet lead to a reduction in the number of viral illnesses?

--

- How does how airplane wing design changes air flow over a wing, leading to decreased drag?

---

## Challenge #1

What kind of statistical question is this?

#### *Is a yet undiagnosed patient's breast cancer tumor malignant or benign?* 

---

## Challenge #2

What kind of statistical question is this?

#### *Is inhalation of marijuana associated with lung cancer?* 

---

## Challenge #2

What kind of statistical question is this?

#### *Does a truncation of the BRCA2 gene cause cancer?* 

---

## Challenge #4

What kind of statistical question is this?

#### *Are there sub-types of ovarian tumors?*

---

### So you know the type of question, now what?

.pull-left[
This helps narrow down the possibilities 
of the kind of analysis you might want to do!

--

For example, if you have the question: **"How many viral illnesses will someone have next year?"**
and you identify that it is **predictive.**
You could narrow down that some kind of statistical or machine learning model 
might help you answer that.

--

Then you need to go a step deeper and look at the data that you have, 
and see which kind of statistical 
or machine learning model is most suitable for your data.
]

.pull-right[
<img src="https://scikit-learn.org/stable/_static/ml_map.png" width=700>

Source: [scikit-learn algorithm cheat sheet](https://scikit-learn.org/stable/tutorial/machine_learning_map/index.html)
]
---

## Another example 

.pull-left[
For example, if you have the question: "Is the gestational length of first born babies the same as that of non-first borns?"
and you identify that it is inferential. 
You could narrow down that some kind of statistical inference approach 
might help you answer that.

--

Then again, you need to go a step deeper and look at the data that you have, 
and see which kind of statistical inference approach is most suitable for your data.
]

.pull-right[
<img src="https://onishlab.colostate.edu/wp-content/uploads/2019/07/which_test_flowchart.png" width=700>

Source: https://onishlab.colostate.edu/summer-statistics-workshop-2019/

Or for another, see this website: http://www.biostathandbook.com/testchoice.html
]

---

## Practice

---

### Case 1

Question: *Is a yet undiagnosed patient's breast cancer tumor malignant or benign?*

Data:

```{r, echo = FALSE, message = FALSE, warning = FALSE}
library(tidyverse)
read_csv("data/wdbc.csv") %>%
    select(ID, Radius:Smoothness, Class) %>%
    tail() %>%
    kable()
```

Data reference: https://archive-beta.ics.uci.edu/ml/datasets/breast+cancer+wisconsin+diagnostic

---

### Case 2

Question: *Is inhalation of marijuana associated with lung cancer?*

Data:

```{r, echo = FALSE, message = FALSE, warning = FALSE}
tibble(ID = c(round(runif(6, 50000, 60000))),
       sex = c("male", "male", "male", "female", "female", "male"),
       gender = c("fluid", "male", "male", "female", "female", "male"),
       age = c(35, 43, 29, 54, 37, 51),
       smoker = c(1, 0, 0, 0, 0, 0),
       marijuana_use = c("never", "frequent", "sometimes", "frequent", "never", "never"),
       bmi = c(22.3, 18, 32.5, 20, 26.1, 29.8),
       lung_cancer = c(0, 0, 1, 0, 0, 1)) %>%
    kable()
```

*Note: this is simulated data.*

---

### Case 3

Question: *Does a truncation of the BRCA2 gene cause cancer?*

Data:

```{r, echo = FALSE, message = FALSE, warning = FALSE}
tibble(ID = c(round(runif(6, 20000, 30000))),
       sex = c("male", "male", "male", "female", "female", "male"),
       gender = c("fluid", "male", "male", "female", "female", "male"),
       age = c(35, 43, 29, 54, 37, 51),
       smoker = c(1, 0, 0, 0, 0, 0),
       bmi = c(22.3, 18, 32.5, 20, 26.1, 29.8),
       brca2_truncation = c(1, 0, 1, 0, 0, 0)) %>%
    kable()
```

*Note: this is simulated data.*

---

### Case 4

Question: *Are there sub-types of ovarian tumors?*

Data:

```{r, echo = FALSE, message = FALSE, warning = FALSE}
library(tidyverse)
read_csv("data/wdbc.csv") %>%
    select(ID, Radius:Smoothness) %>%
    tail() %>%
    kable()
```

*Note: this is simulated data.*

---

## Some key notes:

- identifying whether there even is a response variable is important!

- the kind of response variable/target is critical for narrowing down the method

- the explanatory variables/predictors/features are also important, but I consider these after the response variabe

---

## The statistical landscape in R

Common packages include:

```{r, echo = FALSE, out.width = "80%"}
include_graphics("img/stat-landscape.png")
```

---

## Example of an inferential analysis in R

- case: fruit fly example
- start with visualization (uncertainty focus!)

---

## Example of t-test

- demo formula notation
- demo non-tidy output

---

## Example of ANOVA

---

## Example of linear regression

- again start with visualization
- ref-treatment in R
- demo non-tidy output, and how to get tidy

---

## Common things that go wrong in biostatistics

1. Data analysis does not match the question

2. ...

---
